{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { getAuth, signInWithEmailAndPassword } from 'firebase/auth';\nimport { app } from \"../../firebase\";\nimport { getDoc, doc, getFirestore } from 'firebase/firestore';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { CommonActions } from '@react-navigation/native';\nimport React, { useEffect } from 'react';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { Container, Image } from \"./styles\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar Preload = function Preload(_ref) {\n  var navigation = _ref.navigation;\n  var auth = getAuth(app);\n  var db = getFirestore(app);\n  var getUserCache = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var jsonValue = yield AsyncStorage.getItem('user');\n        return jsonValue != null ? JSON.parse(jsonValue) : null;\n      } catch (e) {\n        console.log('Preload, getUserCache' + e);\n      }\n    });\n    return function getUserCache() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var loginUser = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      var user = yield getUserCache();\n      if (user) {\n        signInWithEmailAndPassword(auth, user.email, user.password).then(function () {\n          navigation.dispatch(CommonActions.reset({\n            index: 0,\n            routes: [{\n              name: 'Home'\n            }]\n          }));\n        }).catch(function (e) {\n          console.log('Preload, login' + e);\n          switch (e.code) {\n            case 'auth/user-not-found':\n              Alert.alert('Erro', 'Usuário não cadastrado');\n              break;\n            case 'auth/invalid-email':\n              Alert.alert('Erro', 'Email inválido');\n              break;\n            case 'auth/wrong-password':\n              Alert.alert('Erro', 'Senha incorreta');\n              break;\n            case 'auth/user-disabled':\n              Alert.alert('Erro', 'Usuário desabilitado');\n              break;\n          }\n        });\n      } else {\n        navigation.dispatch(CommonActions.reset({\n          index: 0,\n          routes: [{\n            name: 'Login'\n          }]\n        }));\n      }\n    });\n    return function loginUser() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    loginUser();\n  }, []);\n  return _jsx(Container, {\n    children: _jsx(Image, {\n      source: require(\"../../src/assets/imagens/Logo.png\"),\n      accessibilityLabel: \"logo do aplicativo CAAmale\\xE3o\"\n    })\n  });\n};\nexport default Preload;","map":{"version":3,"names":["getAuth","signInWithEmailAndPassword","app","getDoc","doc","getFirestore","AsyncStorage","CommonActions","React","useEffect","Alert","Container","Image","jsx","_jsx","Preload","_ref","navigation","auth","db","getUserCache","_ref2","_asyncToGenerator","jsonValue","getItem","JSON","parse","e","console","log","apply","arguments","loginUser","_ref3","user","email","password","then","dispatch","reset","index","routes","name","catch","code","alert","children","source","require","accessibilityLabel"],"sources":["D:/Gabriel Teixeira/Documentos/GitHub/Aplicativo/teste_login2 (visual)/screens/Preload/index.js"],"sourcesContent":["import { getAuth, signInWithEmailAndPassword } from 'firebase/auth'\r\nimport { app } from '../../firebase'\r\nimport { getDoc, doc, getFirestore } from 'firebase/firestore'\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { CommonActions } from '@react-navigation/native'\r\nimport React, { useEffect } from 'react';\r\nimport { Alert } from 'react-native'\r\nimport { Container, Image } from './styles';\r\n\r\nconst Preload = ({navigation}) => {\r\n    const auth = getAuth(app);\r\n    const db = getFirestore(app)\r\n\r\n    //tenta pegar o usuário salvo em cache\r\n    const getUserCache = async () => {\r\n        try {\r\n            const jsonValue = await AsyncStorage.getItem('user')\r\n            return jsonValue != null ? JSON.parse(jsonValue) : null;\r\n            //se retornar não nulo, retornar os dados, do contrário só retorna nulo\r\n        } catch (e) {\r\n            console.log('Preload, getUserCache' + e)\r\n        }\r\n    };\r\n\r\n    const loginUser = async () => {\r\n        const user = await getUserCache();\r\n        if (user) {\r\n            //console.log(user.email);\r\n            //console.log(user.password);\r\n            //se ja estiver salvo em cache (logado previametne) ele vai direto pra home\r\n            signInWithEmailAndPassword(auth, user.email, user.password)\r\n                .then(() => {\r\n                    navigation.dispatch(\r\n                        CommonActions.reset({\r\n                            index: 0,\r\n                            routes: [\r\n                                { name: 'Home' }],\r\n                        })\r\n                    )\r\n                })\r\n                .catch((e) => {\r\n                    console.log('Preload, login' + e)\r\n                    switch (e.code) {\r\n                        case 'auth/user-not-found':\r\n                            Alert.alert('Erro', 'Usuário não cadastrado')\r\n                            break;\r\n                        case 'auth/invalid-email':\r\n                            Alert.alert('Erro', 'Email inválido')\r\n                            break;\r\n                        case 'auth/wrong-password':\r\n                            Alert.alert('Erro', 'Senha incorreta')\r\n                            break;\r\n                        case 'auth/user-disabled':\r\n                            Alert.alert('Erro', 'Usuário desabilitado')\r\n                            break;\r\n                    }\r\n                }\r\n                )\r\n        } else {\r\n            //se não estiver salvo em cache ele vai para login para entrar no app\r\n            //console.log(\"para login\")\r\n            navigation.dispatch(\r\n                CommonActions.reset({\r\n                    index: 0,\r\n                    routes: [\r\n                        { name: 'Login' }],\r\n                })\r\n            )\r\n        }\r\n\r\n\r\n    }\r\n    useEffect(() => {\r\n        loginUser();\r\n    }, [])\r\n\r\n    return (\r\n        <Container>\r\n            <Image source={require('../../src/assets/imagens/Logo.png')}\r\n                accessibilityLabel=\"logo do aplicativo CAAmaleão\"\r\n            >\r\n\r\n            </Image>\r\n\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Preload;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}